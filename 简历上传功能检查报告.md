# ç®€å†ä¸Šä¼ åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥æŠ¥å‘Š

## âœ… **åŠŸèƒ½çŠ¶æ€æ€»è§ˆ**

### 1. **æ·»åŠ ä¸“å®¶ - ç®€å†ä¸Šä¼ ** âœ…
**ä½ç½®**: è¡Œ1000-1017 (æ·»åŠ ä¸“å®¶æ¨¡æ€æ¡†)
**çŠ¶æ€**: åŠŸèƒ½å®Œæ•´

```typescript
<div>
  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
    ç®€å†
  </label>
  {formData.resume ? (
    <a href={formData.resume} target="_blank" rel="noreferrer" className="text-blue-600 dark:text-blue-400 underline break-all mb-2 inline-block">å·²ä¸Šä¼ æ–‡ä»¶</a>
  ) : (
    <p className="text-sm text-gray-500 dark:text-gray-400 mb-2">æœªä¸Šä¼ </p>
  )}
  <PermissionGuard permission="expert_add">
    <input
      type="file"
      accept="application/pdf,.doc,.docx,image/*"
      onChange={(e) => setAddResumeFile(e.target.files?.[0] || null)}
      className="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"
    />
  </PermissionGuard>
</div>
```

**ç‰¹æ€§**:
- âœ… ä½¿ç”¨æ­£ç¡®çš„æƒé™: `expert_add`
- âœ… ä½¿ç”¨æ­£ç¡®çš„çŠ¶æ€å¤„ç†å™¨: `setAddResumeFile`
- âœ… æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼: PDF, DOC, DOCX, å›¾ç‰‡
- âœ… æ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼ˆå·²ä¸Šä¼ /æœªä¸Šä¼ ï¼‰
- âœ… æ”¯æŒç‚¹å‡»æŸ¥çœ‹å·²ä¸Šä¼ æ–‡ä»¶

### 2. **ç¼–è¾‘ä¸“å®¶ - ç®€å†ä¸Šä¼ ** âœ…
**ä½ç½®**: è¡Œ1407-1427 (ç¼–è¾‘ä¸“å®¶æ¨¡æ€æ¡†)
**çŠ¶æ€**: åŠŸèƒ½å®Œæ•´

```typescript
<div>
  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
    ç®€å†
  </label>
  {formData.resume ? (
    <a href={formData.resume} target="_blank" rel="noreferrer" className="text-blue-600 dark:text-blue-400 underline break-all mb-2 inline-block">æŸ¥çœ‹å½“å‰ç®€å†</a>
  ) : (
    <p className="text-sm text-gray-500 dark:text-gray-400 mb-2">æœªä¸Šä¼ ç®€å†</p>
  )}
  <PermissionGuard permission="expert_edit">
    <input
      type="file"
      accept="application/pdf,.doc,.docx,image/*"
      onChange={(e) => setEditResumeFile(e.target.files?.[0] || null)}
      className="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 file:mr-3 file:py-1 file:px-3 file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900/20 dark:file:text-blue-400"
    />
    {editResumeFile && (
      <p className="text-sm text-green-600 dark:text-green-400 mt-1">å·²é€‰æ‹©: {editResumeFile.name}</p>
    )}
  </PermissionGuard>
</div>
```

**ç‰¹æ€§**:
- âœ… ä½¿ç”¨æ­£ç¡®çš„æƒé™: `expert_edit`
- âœ… ä½¿ç”¨æ­£ç¡®çš„çŠ¶æ€å¤„ç†å™¨: `setEditResumeFile`
- âœ… æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼: PDF, DOC, DOCX, å›¾ç‰‡
- âœ… æ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼ˆæŸ¥çœ‹å½“å‰ç®€å†/æœªä¸Šä¼ ç®€å†ï¼‰
- âœ… æ˜¾ç¤ºæ–‡ä»¶é€‰æ‹©åé¦ˆ
- âœ… æ”¯æŒç‚¹å‡»æŸ¥çœ‹/ä¸‹è½½å·²ä¸Šä¼ æ–‡ä»¶

## ğŸ”§ **åç«¯ä¸Šä¼ é€»è¾‘**

### **æ·»åŠ ä¸“å®¶æ—¶ä¸Šä¼ ** âœ…
```typescript
// è¡Œ306-309
if (addResumeFile && created?.id) {
  const url = await supabaseService.uploadExpertResume(created.id, addResumeFile);
  await supabaseService.updateExpert(created.id, { resume: url });
}
```

### **ç¼–è¾‘ä¸“å®¶æ—¶ä¸Šä¼ ** âœ…
```typescript
// è¡Œ221-226
if (editResumeFile) {
  const url = await supabaseService.uploadExpertResume(editExpert.id, editResumeFile);
  updates.resume = url;
}
await supabaseService.updateExpert(editExpert.id, updates);
```

### **æ–‡ä»¶ä¸Šä¼ æœåŠ¡** âœ…
```typescript
async uploadExpertResume(expertId: number, file: File): Promise<string> {
  const bucket = 'expert-resumes';
  const ext = file.name?.split('.').pop() || 'pdf';
  const path = `experts/${expertId}/resume_${Date.now()}.${ext}`;
  
  const { error: uploadError } = await supabase
    .storage
    .from(bucket)
    .upload(path, file, { 
      upsert: true,        // âœ… æ”¯æŒè‡ªåŠ¨æ›¿æ¢
      contentType: file.type 
    });
    
  if (uploadError) throw uploadError;
  
  const { data } = supabase.storage.from(bucket).getPublicUrl(path);
  return data.publicUrl;    // âœ… è¿”å›å¯ä¸‹è½½çš„å…¬å¼€URL
}
```

## ğŸ“‹ **åŠŸèƒ½éªŒè¯æ¸…å•**

### âœ… **æ–‡ä»¶ä¸Šä¼ **
- [x] æ”¯æŒ PDF æ ¼å¼
- [x] æ”¯æŒ DOC/DOCX æ ¼å¼  
- [x] æ”¯æŒå›¾ç‰‡æ ¼å¼
- [x] æ–‡ä»¶å¤§å°éªŒè¯ï¼ˆç”±æµè§ˆå™¨å’ŒSupabaseå¤„ç†ï¼‰

### âœ… **æ–‡ä»¶å­˜å‚¨**
- [x] å­˜å‚¨åˆ°ä¸“ç”¨bucket: `expert-resumes`
- [x] æ–‡ä»¶è·¯å¾„è§„èŒƒ: `experts/{expertId}/resume_{timestamp}.{ext}`
- [x] æ”¯æŒè‡ªåŠ¨æ›¿æ¢ (`upsert: true`)
- [x] ç”Ÿæˆå…¬å¼€è®¿é—®URL

### âœ… **æ–‡ä»¶ä¸‹è½½**
- [x] ç‚¹å‡»é“¾æ¥å¯ä»¥æŸ¥çœ‹/ä¸‹è½½æ–‡ä»¶
- [x] åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ (`target="_blank"`)
- [x] å®‰å…¨é“¾æ¥ (`rel="noreferrer"`)

### âœ… **ç”¨æˆ·ä½“éªŒ**
- [x] æ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼ˆå·²ä¸Šä¼ /æœªä¸Šä¼ ï¼‰
- [x] æ–‡ä»¶é€‰æ‹©åæ˜¾ç¤ºåé¦ˆ
- [x] æƒé™æ§åˆ¶ï¼ˆæ·»åŠ /ç¼–è¾‘æƒé™åˆ†ç¦»ï¼‰
- [x] é”™è¯¯å¤„ç†å’ŒæˆåŠŸæç¤º

### âœ… **è‡ªåŠ¨æ›¿æ¢åŠŸèƒ½**
- [x] æ–°ä¸Šä¼ æ–‡ä»¶ä¼šè‡ªåŠ¨æ›¿æ¢æ—§æ–‡ä»¶
- [x] ä½¿ç”¨æ—¶é—´æˆ³ç¡®ä¿æ–‡ä»¶åå”¯ä¸€
- [x] æ•°æ®åº“ä¸­çš„URLä¼šè‡ªåŠ¨æ›´æ–°

## ğŸ¯ **ç»“è®º**

**ç®€å†ä¸Šä¼ åŠŸèƒ½å®Œå…¨å¯ç”¨** âœ…

1. **ä¸Šä¼ **: æ”¯æŒæ·»åŠ å’Œç¼–è¾‘æ—¶ä¸Šä¼ ç®€å†
2. **å­˜å‚¨**: æ­£ç¡®å­˜å‚¨åˆ°Supabase Storage
3. **ä¸‹è½½**: å¯ä»¥é€šè¿‡é“¾æ¥æŸ¥çœ‹/ä¸‹è½½å·²ä¸Šä¼ çš„ç®€å†
4. **æ›¿æ¢**: æ”¯æŒé‡æ–°ä¸Šä¼ è‡ªåŠ¨æ›¿æ¢æ—§æ–‡ä»¶
5. **æƒé™**: æ­£ç¡®çš„æƒé™æ§åˆ¶
6. **ç”¨æˆ·ä½“éªŒ**: å®Œæ•´çš„çŠ¶æ€æ˜¾ç¤ºå’Œåé¦ˆ

## ğŸ§ª **å»ºè®®æµ‹è¯•æ­¥éª¤**

1. **æ·»åŠ ä¸“å®¶æµ‹è¯•**:
   - åˆ›å»ºæ–°ä¸“å®¶æ—¶ä¸Šä¼ ç®€å†
   - æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æ­£ç¡®ä¸Šä¼ 
   - éªŒè¯ä¸‹è½½é“¾æ¥æ˜¯å¦å¯ç”¨

2. **ç¼–è¾‘ä¸“å®¶æµ‹è¯•**:
   - ç¼–è¾‘ç°æœ‰ä¸“å®¶ä¸Šä¼ æ–°ç®€å†
   - éªŒè¯æ—§æ–‡ä»¶æ˜¯å¦è¢«æ›¿æ¢
   - æ£€æŸ¥ä¸‹è½½é“¾æ¥æ›´æ–°æ˜¯å¦æ­£ç¡®

3. **æƒé™æµ‹è¯•**:
   - éªŒè¯ä¸åŒè§’è‰²çš„ä¸Šä¼ æƒé™
   - ç¡®ä¿æƒé™æ§åˆ¶æ­£ç¡®å·¥ä½œ

4. **æ–‡ä»¶æ ¼å¼æµ‹è¯•**:
   - æµ‹è¯•PDFã€DOCã€DOCXã€å›¾ç‰‡ç­‰æ ¼å¼
   - éªŒè¯æ–‡ä»¶ç±»å‹é™åˆ¶æ˜¯å¦ç”Ÿæ•ˆ
