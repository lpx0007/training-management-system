# è¯¾ç¨‹é”€å”®æ˜Žç»† - æ˜¾ç¤º0æŠ¥åè¯¾ç¨‹

**ä¿®å¤æ—¥æœŸ**: 2025-11-09  
**ä¼˜å…ˆçº§**: ðŸ”´ é«˜  
**çŠ¶æ€**: âœ… å·²å®Œæˆ  

---

## ðŸ“‹ é—®é¢˜æè¿°

### ç”¨æˆ·åé¦ˆ
"ä¼ä¸šæ•°å­—åŒ–å†…æŽ§å®žè·µ ç¬¬2æœŸ åœ¨åŸ¹è®­è®¡åˆ’ä¸­å­˜åœ¨ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åœ¨è¯¾ç¨‹é”€å”®æ˜Žç»†ä¸­è¯†åˆ«åˆ°ï¼Ÿ"

### æ ¹æœ¬åŽŸå› 
**ä¹‹å‰çš„é€»è¾‘**ï¼šåªæ˜¾ç¤ºæœ‰æŠ¥åè®°å½•çš„è¯¾ç¨‹

```typescript
// âŒ æ—§é€»è¾‘ï¼šä»Ž training_participants æŸ¥è¯¢
SELECT DISTINCT training_session_id 
FROM training_participants
WHERE ...

// ç»“æžœï¼šåªèƒ½æ‰¾åˆ°æœ‰æŠ¥åè®°å½•çš„åŸ¹è®­
// å¦‚æžœåŸ¹è®­è¿˜æ²¡æœ‰äººæŠ¥åï¼Œå°±æŸ¥è¯¢ä¸åˆ°
```

**é—®é¢˜**ï¼š
- "ä¼ä¸šæ•°å­—åŒ–å†…æŽ§å®žè·µ ç¬¬2æœŸ"å‚è®­äººæ•° = 0ï¼ˆè¿˜æ²¡æœ‰äººæŠ¥åï¼‰
- å› æ­¤ä¸ä¼šå‡ºçŽ°åœ¨è¯¾ç¨‹é”€å”®æ˜Žç»†ä¸­
- ç”¨æˆ·çœ‹ä¸åˆ°è¿™ä¸ªåŸ¹è®­

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ ¸å¿ƒæ”¹è¿›ï¼šå…ˆæŸ¥åŸ¹è®­ï¼Œå†æŸ¥æŠ¥å

**æ–°é€»è¾‘**ï¼š
```typescript
// âœ… æ–°é€»è¾‘ï¼šä»Ž training_sessions æŸ¥è¯¢
SELECT * FROM training_sessions
WHERE ... (å¯é€‰çš„æ—¶é—´/è¯¾ç¨‹ç­›é€‰)

// ç„¶åŽæŸ¥è¯¢è¿™äº›åŸ¹è®­çš„æŠ¥åè®°å½•
SELECT * FROM training_participants
WHERE training_session_id IN (...)

// ç»“æžœï¼šæ‰€æœ‰åŸ¹è®­éƒ½ä¼šæ˜¾ç¤ºï¼Œå³ä½¿0æŠ¥å
```

---

## ðŸ”§ æŠ€æœ¯å®žçŽ°

### ä¿®æ”¹çš„æ–‡ä»¶
**æ–‡ä»¶**: `src/lib/services/performanceService.ts`  
**å‡½æ•°**: `getCoursePerformanceDetail`

### ä¿®æ”¹æ­¥éª¤

#### æ­¥éª¤1ï¼šå…ˆæŸ¥è¯¢æ‰€æœ‰åŸ¹è®­

```typescript
// æŸ¥è¯¢æ‰€æœ‰åŸ¹è®­ï¼ˆæˆ–æ ¹æ®åŸ¹è®­æ—¥æœŸç­›é€‰ï¼‰
let sessionsQuery = supabase
  .from('training_sessions')
  .select(`
    id, name, date, end_date, area,
    training_mode, online_price, offline_price
  `)
  .order('date', { ascending: false });

// å¦‚æžœé€‰æ‹©äº†æ—¶é—´èŒƒå›´ï¼ŒæŒ‰åŸ¹è®­æ—¥æœŸç­›é€‰
if (timeRange !== 'å…¨éƒ¨' && startDateStr && endDateStr) {
  sessionsQuery = sessionsQuery
    .gte('date', startDateStr)
    .lte('date', endDateStr);
}
```

#### æ­¥éª¤2ï¼šæŸ¥è¯¢æ‰€æœ‰åŸ¹è®­çš„æŠ¥åè®°å½•

```typescript
// æŸ¥è¯¢æ‰€æœ‰åŸ¹è®­çš„æŠ¥åè®°å½•ï¼ˆä¸é™æŠ¥åæ—¥æœŸï¼‰
const sessionIds = sessionsData.map((s: any) => s.id);
const { data: allParticipantsData } = await supabase
  .from('training_participants')
  .select(`...`)
  .in('training_session_id', sessionIds);
```

#### æ­¥éª¤3ï¼šç»Ÿè®¡æ—¶æŒ‰æ—¶é—´èŒƒå›´è¿‡æ»¤

```typescript
// å¦‚æžœé€‰æ‹©äº†æ—¶é—´èŒƒå›´ï¼Œåªç»Ÿè®¡æŠ¥åæ—¥æœŸåœ¨èŒƒå›´å†…çš„å‚è®­äººå‘˜
let rangeParticipants = allParticipants;
if (timeRange !== 'å…¨éƒ¨' && startDateStr && endDateStr) {
  rangeParticipants = allParticipants.filter((p: any) => {
    const regDate = p.registration_date;
    return regDate >= startDateStr && regDate <= endDateStr;
  });
}

// ç»Ÿè®¡
const onlineCount = rangeParticipants.filter(...).length;
const offlineCount = rangeParticipants.filter(...).length;
const totalRevenue = rangeParticipants.reduce(...);
```

---

## ðŸ“Š æ•ˆæžœå¯¹æ¯”

### ä¿®å¤å‰ âŒ

```
è¯¾ç¨‹é”€å”®æ˜Žç»†ï¼ˆåªæ˜¾ç¤ºæœ‰æŠ¥åçš„ï¼‰:
âœ… AIè®¤è¯åŸ¹è®­ - 5äººï¼ŒÂ¥15,000
âœ… æ•æ·é¡¹ç›®ç®¡ç†å®žè·µ - 3äººï¼ŒÂ¥9,000
âŒ ä¼ä¸šæ•°å­—åŒ–å†…æŽ§å®žè·µ ç¬¬2æœŸ - ä¸æ˜¾ç¤ºï¼ˆ0äººï¼‰
```

### ä¿®å¤åŽ âœ…

```
è¯¾ç¨‹é”€å”®æ˜Žç»†ï¼ˆæ˜¾ç¤ºæ‰€æœ‰è¯¾ç¨‹ï¼‰:
âœ… AIè®¤è¯åŸ¹è®­ - 5äººï¼ŒÂ¥15,000
âœ… æ•æ·é¡¹ç›®ç®¡ç†å®žè·µ - 3äººï¼ŒÂ¥9,000
âœ… ä¼ä¸šæ•°å­—åŒ–å†…æŽ§å®žè·µ ç¬¬2æœŸ - 0äººï¼ŒÂ¥0  â­ çŽ°åœ¨æ˜¾ç¤ºäº†ï¼
âœ… å…¶ä»–æ‰€æœ‰åŸ¹è®­ - å³ä½¿0äººä¹Ÿæ˜¾ç¤º
```

---

## ðŸŽ¯ æŸ¥è¯¢é€»è¾‘è¯¦è§£

### æƒ…å†µ1ï¼šé€‰æ‹©"å…¨éƒ¨"

**æŸ¥è¯¢**ï¼š
```sql
-- æŸ¥è¯¢æ‰€æœ‰åŸ¹è®­
SELECT * FROM training_sessions
ORDER BY date DESC;

-- æŸ¥è¯¢æ‰€æœ‰æŠ¥åè®°å½•
SELECT * FROM training_participants
WHERE training_session_id IN (...);
```

**ç»Ÿè®¡**ï¼š
- ç»Ÿè®¡æ‰€æœ‰æŠ¥åè®°å½•
- å³ä½¿0æŠ¥åï¼Œä¹Ÿæ˜¾ç¤ºè¯¥åŸ¹è®­

**ç»“æžœ**ï¼š
```
æ˜¾ç¤ºï¼šæ‰€æœ‰åŸ¹è®­
ç»Ÿè®¡ï¼šæ‰€æœ‰æŠ¥å
```

### æƒ…å†µ2ï¼šé€‰æ‹©"æœ¬æœˆ"

**æŸ¥è¯¢**ï¼š
```sql
-- æŸ¥è¯¢åŸ¹è®­æ—¥æœŸåœ¨æœ¬æœˆçš„åŸ¹è®­
SELECT * FROM training_sessions
WHERE date >= '2025-11-01' 
  AND date <= '2025-11-30'
ORDER BY date DESC;

-- æŸ¥è¯¢è¿™äº›åŸ¹è®­çš„æ‰€æœ‰æŠ¥åè®°å½•ï¼ˆä¸é™æŠ¥åæ—¥æœŸï¼‰
SELECT * FROM training_participants
WHERE training_session_id IN (...);
```

**ç»Ÿè®¡**ï¼š
```typescript
// åªç»Ÿè®¡æŠ¥åæ—¥æœŸåœ¨æœ¬æœˆçš„æŠ¥å
const rangeParticipants = allParticipants.filter(p => 
  p.registration_date >= '2025-11-01' && 
  p.registration_date <= '2025-11-30'
);
```

**ç»“æžœ**ï¼š
```
æ˜¾ç¤ºï¼šåŸ¹è®­æ—¥æœŸåœ¨æœ¬æœˆçš„æ‰€æœ‰åŸ¹è®­ï¼ˆåŒ…æ‹¬0æŠ¥åï¼‰
ç»Ÿè®¡ï¼šæŠ¥åæ—¥æœŸåœ¨æœ¬æœˆçš„æŠ¥åè®°å½•
```

---

## ðŸ“ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæŸ¥çœ‹æ‰€æœ‰åŸ¹è®­ï¼ˆé»˜è®¤ï¼‰
```
æ“ä½œï¼šè¿›å…¥é¡µé¢ï¼Œé»˜è®¤"å…¨éƒ¨"
ç»“æžœï¼š
  - æ˜¾ç¤ºæ‰€æœ‰åŸ¹è®­ï¼ŒåŒ…æ‹¬è¿˜æ²¡æœ‰äººæŠ¥åçš„
  - å‚è®­äººæ•°=0çš„åŸ¹è®­ä¹Ÿä¼šæ˜¾ç¤º
  - å¯ä»¥çœ‹åˆ°å®Œæ•´çš„åŸ¹è®­åˆ—è¡¨
```

### åœºæ™¯2ï¼šæŸ¥çœ‹æœ¬æœˆåŸ¹è®­
```
æ“ä½œï¼šé€‰æ‹©"æœ¬æœˆ"
ç»“æžœï¼š
  - æ˜¾ç¤ºåŸ¹è®­æ—¥æœŸåœ¨æœ¬æœˆçš„æ‰€æœ‰åŸ¹è®­
  - åŒ…æ‹¬è¿˜æ²¡æœ‰äººæŠ¥åçš„åŸ¹è®­ï¼ˆæ˜¾ç¤º0äººï¼‰
  - ç»Ÿè®¡åªè®¡ç®—æœ¬æœˆçš„æŠ¥å
```

### åœºæ™¯3ï¼šåŸ¹è®­è¿˜æ²¡æŠ¥å
```
åŸ¹è®­ï¼šä¼ä¸šæ•°å­—åŒ–å†…æŽ§å®žè·µ ç¬¬2æœŸ
å¼€è¯¾æ—¥æœŸï¼š2026-10-22
å‚è®­äººæ•°ï¼š0äºº
æŠ¥åè®°å½•ï¼šæ— 

ä¿®å¤å‰ï¼šä¸æ˜¾ç¤º âŒ
ä¿®å¤åŽï¼šæ˜¾ç¤ºï¼Œå‚è®­äººæ•°=0ï¼Œæ”¶å…¥=Â¥0 âœ…
```

### åœºæ™¯4ï¼šè·¨æœˆæŠ¥å
```
åŸ¹è®­ï¼šAIè®¤è¯åŸ¹è®­
å¼€è¯¾æ—¥æœŸï¼š2025-11-15
æŠ¥åè®°å½•ï¼š
  - 2025-10-20: 2äºº
  - 2025-11-05: 3äºº

é€‰æ‹©"æœ¬æœˆ"ï¼š
  - æ˜¾ç¤ºï¼šAIè®¤è¯åŸ¹è®­ âœ…
  - å‚è®­äººæ•°ï¼š3äºº âœ…ï¼ˆåªç»Ÿè®¡11æœˆæŠ¥åçš„ï¼‰
  - æ”¶å…¥ï¼šÂ¥9,000 âœ…ï¼ˆåªç»Ÿè®¡11æœˆæŠ¥åçš„ï¼‰
```

---

## ðŸŽ¨ ç•Œé¢æ•ˆæžœ

### 0æŠ¥åçš„åŸ¹è®­æ˜¾ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¯¾ç¨‹åç§°                å¼€è¯¾æ—¥æœŸ    å‚è®­äººæ•°    æ”¶å…¥   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ AIè®¤è¯åŸ¹è®­              2025-11-15   5äºº     Â¥15,000  â”‚
â”‚ ä¼ä¸šæ•°å­—åŒ–ç¬¬2æœŸ         2026-10-22   0äºº     Â¥0      â”‚ â­
â”‚ æ•æ·é¡¹ç›®ç®¡ç†            2025-11-13   3äºº     Â¥9,000   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ¨ å…³é”®ä¼˜åŠ¿

### 1. **å®Œæ•´æ€§** âœ…
- æ˜¾ç¤ºæ‰€æœ‰åŸ¹è®­ï¼Œä¸é—æ¼
- å³ä½¿è¿˜æ²¡æœ‰äººæŠ¥åï¼Œä¹Ÿèƒ½çœ‹åˆ°

### 2. **çœŸå®žæ€§** âœ…
- çœŸå®žåæ˜ åŸ¹è®­è®¡åˆ’
- 0æŠ¥åçš„åŸ¹è®­ç”¨æˆ·ä¹Ÿèƒ½çœ‹åˆ°

### 3. **çµæ´»æ€§** âœ…
- æ”¯æŒæ—¶é—´ç­›é€‰
- ç»Ÿè®¡å‡†ç¡®ï¼ˆåªè®¡ç®—èŒƒå›´å†…çš„æŠ¥åï¼‰

### 4. **ä¸šåŠ¡ä»·å€¼** âœ…
- **åŸ¹è®­ç®¡ç†è€…** - å¯ä»¥çœ‹åˆ°æ‰€æœ‰åŸ¹è®­ï¼ŒåŒ…æ‹¬é”€å”®ä¸ä½³çš„
- **é”€å”®äººå‘˜** - å¯ä»¥çœ‹åˆ°å“ªäº›åŸ¹è®­è¿˜æ²¡äººæŠ¥åï¼Œéœ€è¦æŽ¨å¹¿
- **å†³ç­–è€…** - å¯ä»¥çœ‹åˆ°å®Œæ•´çš„åŸ¹è®­åˆ—è¡¨ï¼Œåšå‡ºæ›´å¥½çš„å†³ç­–

---

## ðŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•1ï¼š0æŠ¥ååŸ¹è®­æ˜¾ç¤º
- [x] åˆ›å»ºä¸€ä¸ªæ–°åŸ¹è®­ï¼Œä¸æ·»åŠ ä»»ä½•æŠ¥å
- [x] è¿›å…¥è¯¾ç¨‹é”€å”®æ˜Žç»†
- [x] è¯¥åŸ¹è®­æ˜¾ç¤ºï¼Œå‚è®­äººæ•°=0

### æµ‹è¯•2ï¼šæ—¶é—´ç­›é€‰æ­£ç¡®
- [x] é€‰æ‹©"æœ¬æœˆ"
- [x] åªæ˜¾ç¤ºæœ¬æœˆå¼€è¯¾çš„åŸ¹è®­ï¼ˆåŒ…æ‹¬0æŠ¥åï¼‰
- [x] ç»Ÿè®¡åªè®¡ç®—æœ¬æœˆçš„æŠ¥å

### æµ‹è¯•3ï¼šæ•°æ®å‡†ç¡®æ€§
- [x] 0æŠ¥ååŸ¹è®­ï¼šå‚è®­äººæ•°=0ï¼Œæ”¶å…¥=Â¥0
- [x] æœ‰æŠ¥ååŸ¹è®­ï¼šæ•°æ®ç»Ÿè®¡æ­£ç¡®
- [x] è·¨æœˆæŠ¥åï¼šåªç»Ÿè®¡é€‰æ‹©æœˆä»½çš„æŠ¥å

### æµ‹è¯•4ï¼šä¸šåŠ¡å‘˜æ˜Žç»†
- [x] 0æŠ¥ååŸ¹è®­ï¼šä¸šåŠ¡å‘˜æ˜Žç»†ä¸ºç©ºï¼ˆæ˜¾ç¤º"æš‚æ— ä¸šåŠ¡å‘˜æ•°æ®"ï¼‰
- [x] æœ‰æŠ¥ååŸ¹è®­ï¼šä¸šåŠ¡å‘˜æ˜Žç»†æ­£ç¡®

---

## ðŸ“š ç›¸å…³æ–‡æ¡£

- `docs/ä¿®å¤-è¯¾ç¨‹é”€å”®æ˜Žç»†è¯†åˆ«é—®é¢˜.md` - ä¹‹å‰çš„ä¿®å¤ï¼ˆæŒ‰æŠ¥åæ—¥æœŸç­›é€‰ï¼‰
- `docs/è¯¾ç¨‹é”€å”®æ˜Žç»†-é»˜è®¤æ˜¾ç¤ºå…¨éƒ¨è¯¾ç¨‹.md` - æ·»åŠ æ—¶é—´ç­›é€‰å™¨
- `docs/è¯¾ç¨‹é”€å”®æ˜Žç»†æ˜¾ç¤ºé€»è¾‘è¯´æ˜Ž.md` - æ˜¾ç¤ºé€»è¾‘è¯´æ˜Ž

---

## ðŸŽ‰ æ€»ç»“

### æ ¸å¿ƒæ”¹è¿›

**ä¹‹å‰**ï¼š
```
åªæ˜¾ç¤ºæœ‰æŠ¥åè®°å½•çš„è¯¾ç¨‹
â†’ "ä¼ä¸šæ•°å­—åŒ–ç¬¬2æœŸ"æ²¡äººæŠ¥åï¼Œä¸æ˜¾ç¤º âŒ
```

**çŽ°åœ¨**ï¼š
```
æ˜¾ç¤ºæ‰€æœ‰è¯¾ç¨‹ï¼ŒåŒ…æ‹¬0æŠ¥åçš„
â†’ "ä¼ä¸šæ•°å­—åŒ–ç¬¬2æœŸ"æ˜¾ç¤ºï¼Œå‚è®­äººæ•°=0 âœ…
```

### æŠ€æœ¯è¦ç‚¹

1. **æŸ¥è¯¢é¡ºåºæ”¹å˜** - ä»Ž"æŸ¥æŠ¥åæ‰¾åŸ¹è®­"æ”¹ä¸º"æŸ¥åŸ¹è®­æ‰¾æŠ¥å"
2. **åˆ†ç¦»æ˜¾ç¤ºä¸Žç»Ÿè®¡** - æ˜¾ç¤ºæ‰€æœ‰åŸ¹è®­ï¼Œç»Ÿè®¡æŒ‰æ—¶é—´èŒƒå›´
3. **æ”¯æŒ0æŠ¥å** - å³ä½¿æ²¡æœ‰æŠ¥åè®°å½•ï¼Œä¹Ÿæ˜¾ç¤ºåŸ¹è®­

### ä¸šåŠ¡ä»·å€¼

- âœ… **å®Œæ•´æ€§** - çœ‹åˆ°æ‰€æœ‰åŸ¹è®­è®¡åˆ’
- âœ… **å¯è§æ€§** - å‘çŽ°éœ€è¦æŽ¨å¹¿çš„åŸ¹è®­
- âœ… **å†³ç­–æ”¯æŒ** - åŸºäºŽå®Œæ•´æ•°æ®åšå†³ç­–

---

**ä¿®å¤æ—¶é—´**: 2025-11-09 18:20  
**çŠ¶æ€**: ðŸŸ¢ å®Œæˆå¹¶éªŒè¯  
**å½±å“èŒƒå›´**: è¯¾ç¨‹é”€å”®æ˜Žç»†é¡µé¢  

**çŽ°åœ¨æ‰€æœ‰åŸ¹è®­éƒ½ä¼šæ˜¾ç¤ºï¼ŒåŒ…æ‹¬è¿˜æ²¡æœ‰äººæŠ¥åçš„ï¼** ðŸŽ‰
